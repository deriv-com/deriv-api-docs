---
title: Аутентификация API
hide_title: false
draft: false
sidebar_label: Аутентификация API
sidebar_position: 2
tags:
  - аутентификация
  - авторизация
keywords:
  - deriv-authentication
  - deriv-authorisatio
description: Получите доступ к полному набору функций Deriv API в своем торговом приложении, аутентифицировав пользователей с помощью API-токена. Научитесь делать это на примере API.
---

Без авторизации и аутентификации Вы получите доступ только к половине наших API-вызовов и функций. Например, чтобы покупать контракты или использовать функции `Копийной торговли`, Ваши пользователи должны пройти аутентификацию и авторизацию у нашего провайдера **OAuth** и **WebSocket Server**.

## Прежде чем мы начнем

Пожалуйста, убедитесь, что у Вас есть все требования, указанные ниже, чтобы продолжить.

### Требования

1. Счет клиента Deriv
2. Токен API Deriv с соответствующим уровнем доступа
3. ID производного приложения

:::note
Обратитесь к разделу [Настройка приложения Deriv] (/docs/setting-up-a-deriv-application) за подробными инструкциями о том, как создать токен API Deriv и приложение.
:::

### Ключ API

API-токен - это уникальный идентификатор клиента, который запрашивает доступ у сервера. Это самый простой способ авторизации.

Уровень доступа для каждого API-токена должен соответствовать требуемому уровню доступа для каждого вызова API, который также можно найти в [API Explorer](/api-explorer).

Например, на скриншоте ниже Вы видите, что для использования состояния счета необходимо использовать токен с уровнем доступа для чтения.

![](/img/acc_status_scope_api_explorer.png)

После авторизации соединения WebSocket последующие вызовы по этому соединению будут считаться действиями пользователя.

Имейте в виду, что API-токен может быть использован в любом приложении, поэтому и Ваше приложение, и Ваши клиенты должны обеспечить его безопасность.

### OAuth2

OAuth расшифровывается как `Открытая авторизация` - протокол, который позволяет клиенту получать доступ к ресурсам, размещенным на сервере, от имени пользователя, не раскрывая его учетных данных.

Этот тип авторизации позволяет клиентам входить в сторонние приложения, используя свои учетные записи Deriv, без создания API-токена. В этом случае стороннее приложение не видит пароль пользователя или постоянный API-токен, что делает его более безопасным.

Аутентификация OAuth2 требует больше шагов для настройки, но это самый безопасный способ для разработчиков предоставить доступ к своему приложению клиентам.

Для получения дополнительной информации об OAuth2 посетите [это руководство](https://aaronparecki.com/oauth-2-simplified/).

Вот наглядное представление того, как работает авторизационное соединение OAuth:

![OAuth flow](/img/how_oauth_works.png "OAuth flow")

## Процесс аутентификации

Чтобы аутентифицировать пользователя, укажите URL, который будет использоваться в качестве OAuth Redirect URL на странице [Dashboard](/dashboard), вкладка **Регистрация приложения** в полях **OAuth details**. Затем добавьте кнопку входа на свой сайт или в приложение и направьте пользователей по адресу **`https://oauth.deriv.com/oauth2/authorize?app_id=your_app_id`**, где your_app_id - это ID Вашего приложения.

![Deriv OAuth Login](/img/oauth_login.png "Deriv OAuth Login")

Как только пользователь зарегистрируется/войдет в систему, он будет перенаправлен на URL, который Вы ввели в качестве URL перенаправления. К этому URL будут добавлены аргументы с маркерами сессии пользователя, и он будет выглядеть примерно так:

`https://[YOUR_WEBSITE_URL]/redirect/?acct1=cr799393& token1=a1-f7pnteezo4jzhpxclctizt27hyeot&cur1=usd& acct2=vrtc1859315& token2=a1clwe3vfuuus5kraceykdsoqm4snfq& cur2=usd`.

## Процесс авторизации

Параметры запроса в URL перенаправления - это учетные записи пользователей и связанные с ними токены сессий. Вы можете сопоставить параметры запроса с массивом, используя следующий подход:

```js showLineNumbers
const user_accounts = [
  {
    account: 'cr799393',
    token: 'a1-f7pnteezo4jzhpxclctizt27hyeot',
    currency: 'usd',
  },
  {
    account: 'vrtc1859315',
    token: 'a1clwe3vfuuus5kraceykdsoqm4snfq',
    currency: 'usd',
  },
];
```

Чтобы авторизовать пользователя на основе **выбранной** учетной записи, вызовите API-вызов [authorize](/api-explorer#authorize), указав **выбранную** учетную запись пользователя **токен сессии**:

```js showLineNumbers
{
  "authorize": "a1-f7pnteezo4jzhpxclctizt27hyeot"
}
```

Ответом на вызов `authorize` будет объект, как показано ниже:

```js showLineNumbers
{
    "account_list": [
      {
        "account_type": "торговый",
        "created_at": 1647509550,
        "currency": "USD",
        "is_disabled": 0,
        "is_virtual": 0,
        "landing_company_name": "svg",
        "loginid": "CR799393",
        "trading": {}
      },
      {
        "account_type": "trading",
        "created_at": 1664132232,
        "currency": "ETH",
        "is_disabled": 0,
        "is_virtual": 0,
        "landing_company_name": "svg",
        "loginid": "VRTC1859315",
        "trading": {}
      },
    ],
    "баланс": 0,
    "страна": "id",
    "валюта": "USD",
    "email": "user_mail@email_provider.com",
    "fullname": " John Doe",
    "is_virtual": 0,
    "landing_company_fullname": "Deriv (SVG) LLC",
    "landing_company_name": "svg",
    "local_currencies": {
      "IDR": {
        "fractional_digits": 2
      }
    } },
    "loginid": "CR799393",
    "preferred_language": "EN",
    "scopes": [
      "read",
      "trade",
      "trading_information",
      "payments",
      "admin"
    ],
    "trading": {},
    "upgradeable_landing_companies": [
      "svg"
    ],
    "user_id": 12345678
}
```

Теперь пользователь авторизован, и Вы можете использовать вызовы Deriv API от имени учетной записи.
